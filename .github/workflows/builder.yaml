name: ğŸ¦ ğŸ¦ ğŸ¦ âœ¨âœ¨Testâœ¨âœ¨ğŸ¦ ğŸ¦ ğŸ¦ ğŸš€ 

on:
  workflow_dispatch:
  schedule:
    - cron: '0 23 * * *'
env:
  CI: true
  GITHUB_ACTIONS: true
  DOCKER_BUILDKIT: 1
  NUM_JOBS: 4


jobs:
#
# GNU/Linux
#

  lin:
    strategy:
      fail-fast: false
      max-parallel: 4
      matrix:
          include: [
          { os: 16, backend: mcode },
          { os: 18, backend: mcode },
          { os: 20, backend: mcode },
          { os: 16, backend: llvm-5.0 },
          { os: 18, backend: llvm-5.0 },
          { os: 20, backend: llvm-10 },
          { os: 18, backend: gcc-8.3.0 },
          { os: 20, backend: gcc-9.3.0 }
        ]
    name: 'ğŸ§â¤ï¸ğŸ¥µUbuntu ${{ matrix.os }} Â· ${{ matrix.backend }} ğŸ’¥â¤ï¸'
    runs-on: ubuntu-${{ matrix.os }}.04
    timeout-minutes: 360
    steps:

    - name: 'ğŸ§°ğŸ¦Šâ¤ï¸CheckoutğŸ”¥ğŸ”¥ğŸ¦ ğŸ¦ '
      uses: actions/checkout@v2

    - name: 'ğŸ›³ï¸ ğŸ–¥ï¸Build and in containersğŸ”¥ğŸ”¥'
      run: |
        TASK=ubuntu${{ matrix.os }}+${{ matrix.backend }} 
        chmod u+r+x node.sh
        ./node.sh
    - name: 'ğŸ“¤ Upload artifact: packageğŸ¦ '
      uses: actions/upload-artifact@v2
      with:
        path: ghdl-gha-ubuntu-*.tgz
